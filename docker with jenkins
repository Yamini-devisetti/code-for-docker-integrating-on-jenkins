pipeline{

    agent any
    tools{
        maven 'mymaven'
    }
    stages{
        stage('checkout code')
        {
            steps{ 
            git 'url'
        }
        }

    stage('Test the code'){
        steps{
            sh 'mvn test'
        }

    }
    stage('build the code'){
        steps{
            sh 'mvn package'
        }
    }
stage('Build the Image'){
        steps{
            sh 'docker build -t myimageaddressbook .'
        }
    }
stage('Deploy the code'){
        steps{
            sh 'docker run -d -P myimageaddressbook'
        }
    }
    }
}








After saving the code before building we have to give permissions as
                    chmod -R 777 /var/run/docker.sock

Then later on
            docker ps -a  for container creation
            docker images     for cheecking the images

To check the output
    public ipv4:32768/addressbook(artifact name)

If we want to add our own address book 

stage('Build the Image'){
        steps{
            sh 'docker build -t myimageaddressbook:$BUILD_NUMBER .'
        }
    }


stage('Deploy the code'){
        steps{
            sh 'docker run -d -P myimageaddressbook:$BUILD_NUMBER'
        }
    }



